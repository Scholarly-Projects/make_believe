---
# "Image Citations" page layout
# Mirrors the bibliography layout structure but pulls image_citation fields
# from whatever CSV is designated as `metadata` in _config.yml, filtered to
# only items that have a non-empty image_citation value.
layout: default
---
{% include essay/header-scrollytelling.html %}
{% if page.about-featured-image or page.heading or page.sub-heading %}
{% assign jumboId = page.about-featured-image %}
{% if jumboId contains '/' %}
{% assign jumboSrc = jumboId | relative_url %}
{% else %}
{% assign jumboItem = site.data[site.metadata] | where: "objectid", jumboId | first %}
{% capture jumboSrc %}{{ jumboItem.object_location | default: jumboItem.image_small | relative_url }}{% endcapture %}
{%- endif -%}
<style>
    #about-feature {
        padding: 4rem 0;
        margin-bottom: 1rem;
        {% if page.about-featured-image %}
        background-color: #e9ecef;
        background-image: url({{ jumboSrc }});
        background-size: cover;
        background-repeat: no-repeat;
        background-position: {{ page.position | default: 'center' }};{% endif %}
    }
    {% if page.padding %}
    .about-title-box {
        padding-top: {{ page.padding }};
        padding-bottom: 1em;
    }
    {%- endif -%}
    .about-title {
        padding-left: 15% !important;
    }
    @media screen and (max-width: 576px) {
        .about-title-box {
            padding-top: min({{ page.padding }}, 45vh);
        }
        .about-title {
            padding-left: 1rem !important;
        }
    }
</style>
<div id="about-feature">
    <div class="about-title-box">
        {% if page.heading or page.sub-heading %}
        <div class="p-2 text-start text-white bg-dark bg-opacity-75 about-title">
            {% if page.heading %}<h2 class="display-1">{{ page.heading }}</h2>{% endif %}
            {% if page.sub-heading %}<h3 class="about-tagline h5">{{ page.sub-heading }}</h3>{% endif %}
        </div>
        {% endif %}
    </div>
</div>
{% endif %}
<style>
    #about-wrapper {
        padding-top: 120px;
        padding-bottom: 6rem; /* Clears the fixed scrollytelling footer */
    }
    @media screen and (max-width: 768px) {
        #about-wrapper {
            padding-top: 100px;
            padding-bottom: 5rem;
        }
    }

    /* ── Image citation list ───────────────────────────────────────────── */
    #image-citation-list {
        list-style: none;
        padding-left: 0;
    }
    #image-citation-list li {
        display: flex;
        align-items: flex-start;
        gap: 1.5rem;
        margin-bottom: 0.75em;
        line-height: 1.6;
        /* Offset anchor so the fixed footer doesn't obscure the target entry */
        scroll-margin-top: 140px;
    }

    /* Thumbnail column */
    .img-cite-thumb-col {
        flex: 0 0 60px;
        display: flex;
        align-items: flex-start;
        padding-top: 0.1em;
    }
    .img-cite-thumb {
        width: 60px;
        height: 60px;
        object-fit: cover;
        border-radius: 3px;
        display: block;
        opacity: 0.85;
        transition: opacity 0.2s ease;
    }
    .img-cite-thumb:hover {
        opacity: 1;
    }

    /* Citation text column — hanging indent */
    .img-cite-text {
        flex: 1 1 auto;
        padding-left: 2em;
        text-indent: -2em;
    }

    /* "View Item" link column */
    .img-cite-link-col {
        flex: 0 0 5.5rem;
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        padding-top: 0.1em;
    }
    .img-cite-link {
        font-size: 0.85em;
        color: #2563eb;
        text-decoration: none;
        border: 1px solid #2563eb;
        border-radius: 3px;
        padding: 0 0.4em;
        line-height: 1.5;
        white-space: nowrap;
        transition: color 0.15s ease, background-color 0.15s ease;
    }
    .img-cite-link:hover {
        color: #fff;
        background-color: #2563eb;
        text-decoration: none;
    }

    /* Highlight when jumping directly to an entry via anchor */
    #image-citation-list li:target {
        background-color: rgba(255, 220, 100, 0.15);
        border-left: 3px solid rgba(255, 220, 100, 0.6);
        padding-left: 0;
        border-radius: 2px;
        transition: background-color 0.3s ease;
    }
    #image-citation-list li:target .img-cite-text {
        padding-left: calc(2em - 3px);
    }
</style>
<div id="about-wrapper">
    <div id="about-toc-wrapper">
        {% unless page.toc == false %}
        <div id="about-toc">
            <div id="about-toc-title">
                <button class="btn btn-light" data-bs-toggle="collapse" data-bs-target="#about-toc-list" aria-expanded="false" aria-controls="about-toc-list">
                    Contents
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
                    </svg>
                </button>
            </div>
            <div id="about-toc-list" class="collapse">
                {% include cb/jekyll-toc.html html=content sanitize=true h_min=1 h_max=3 skip_no_ids=true class="jekyll-toc-list" credits=page.credits %}
            </div>
        </div>
        {% endunless %}
    </div>

    <div id="about-contents-wrapper">
        {{ content }}

        {%- comment -%}
          Pull every row from the configured metadata CSV that has a non-blank
          image_citation value, then sort alphabetically by that field so the
          list reads like a conventional image credits page.
          Each <li> is anchored by the item's objectid so the scrollytelling
          footer's "View Item" link and the sidebar citation display can deep-link
          directly to the relevant entry with /image.html#<objectid>.
        {%- endcomment -%}
        {%- assign all_items = site.data[site.metadata] -%}
        {%- assign cited_items = all_items | where_exp: "item", "item.image_citation and item.image_citation != ''" | sort: "image_citation" -%}

        {% if cited_items %}
        <ul id="image-citation-list">
            {% for item in cited_items %}
            <li id="{{ item.objectid }}">

                {%- comment -%} Thumbnail — links to the item page {%- endcomment -%}
                <div class="img-cite-thumb-col">
                    {% if item.image_thumb or item.image_small %}
                    <a href="{{ site.baseurl }}/items/{{ item.objectid }}.html" aria-label="View {{ item.title }}">
                        <img
                            src="{{ item.image_thumb | default: item.image_small | relative_url }}"
                            alt="{{ item.image_alt_text | default: item.title }}"
                            class="img-cite-thumb"
                            loading="lazy"
                        >
                    </a>
                    {% endif %}
                </div>

                {%- comment -%} Citation text with italic/bold Markdown rendered {%- endcomment -%}
                <span class="img-cite-text">{{ item.image_citation | markdownify | remove: '<p>' | remove: '</p>' | strip }}</span>

                {%- comment -%} View Item link {%- endcomment -%}
                <div class="img-cite-link-col">
                    <a href="{{ site.baseurl }}/items/{{ item.objectid }}.html" class="img-cite-link">
                        View Item
                    </a>
                </div>

            </li>
            {% endfor %}
        </ul>
        {% endif %}
    </div>

    {% if page.credits == true %}
    <div id="credits-contents-wrapper">
        {% include cb/credits.html %}
    </div>
    {% endif %}
</div>
{% include essay/footer-scrollytelling.html %}